<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <title>‚öôÔ∏è Admin Panel | Anti-Filtras</title>
    <link rel="stylesheet" href="../style.css">
</head>
<body>
    <div id="login" style="text-align:center; padding-top: 150px;">
        <img src="../logo.webp" width="120" style="margin-bottom:20px;">
        <h2 style="letter-spacing:2px;">üîê ACCESO STAFF</h2>
        <input type="password" id="pass" placeholder="Contrase√±a" style="padding:15px; width:250px; border-radius:8px; border:1px solid #333; background:#111; color:white;">
        <br><br>
        <button onclick="checkPass()" style="padding:15px 30px; background:#00ff88; color:black; border:none; border-radius:8px; font-weight:bold; cursor:pointer;">ENTRAR üöÄ</button>
    </div>

    <div id="panel" style="display:none;" class="container">
        <div class="admin-card" style="background:#111; padding:40px; border-radius:15px; border:1px solid #222;">
            <h2 style="text-align:center; color:#00ff88; margin-bottom:30px;">‚öôÔ∏è CONTROL DE SERVICIOS</h2>
            <div id="btn-container"></div>
            <p style="text-align:center; margin-top:30px;"><a href="../index.html" style="color:#555; text-decoration:none;">‚¨ÖÔ∏è Volver a la Web</a></p>
        </div>
    </div>

    <script type="module">
        import { initializeApp } from "https://www.gstatic.com/firebasejs/10.7.1/firebase-app.js";
        import { getFirestore, doc, updateDoc, onSnapshot } from "https://www.gstatic.com/firebasejs/10.7.1/firebase-firestore.js";

        const firebaseConfig = {
            apiKey: "AIzaSyAEUOzOWdq0xs3qiIlX1RzB6bpKkkMLykA",
            authDomain: "antifiltras-7116d.firebaseapp.com",
            projectId: "antifiltras-7116d",
            appId: "1:795745598666:web:72b77816d3c2a3c17f8833"
        };

        const app = initializeApp(firebaseConfig);
        const db = getFirestore(app);

        window.checkPass = () => {
            if(document.getElementById('pass').value === 'Antifiltras2026') {
                document.getElementById('login').style.display = 'none';
                document.getElementById('panel').style.display = 'block';
            } else { alert('‚ùå Acceso Denegado'); }
        };

        onSnapshot(doc(db, "BOT_CONTROL", "settings"), (s) => {
            if(!s.exists()) return;
            const d = s.data();
            const c = document.getElementById('btn-container');
            c.innerHTML = `
                ${renderBtn('üì© Tickets', 'ticketsEnabled', d.ticketsEnabled)}
                ${renderBtn('üö´ Baneos', 'bansEnabled', d.bansEnabled)}
                ${renderBtn('‚öôÔ∏è Config', 'configEnabled', d.configEnabled)}
            `;
        });

        window.toggleFunc = async (f, v) => {
            let next = v === 1 ? 2 : (v === 2 ? 0 : 1);
            await updateDoc(doc(db, "BOT_CONTROL", "settings"), { [f]: next });
        };

        function renderBtn(label, field, val) {
            let cfg = { 1: {c:'#00ff88', t:'üü¢ NORMAL'}, 2: {c:'#ffcc00', t:'üü° MANTENIMIENTO'}, 0: {c:'#ff3e3e', t:'üî¥ CERRADO'} }[val];
            return `
                <div style="display:flex; justify-content:space-between; align-items:center; padding:20px 0; border-bottom:1px solid #222;">
                    <span style="font-weight:bold;">${label}</span>
                    <button onclick="toggleFunc('${field}', ${val})" style="background:${cfg.c}; color:#000; border:none; padding:10px 20px; border-radius:5px; font-weight:bold; cursor:pointer; min-width:150px;">
                        ${cfg.t}
                    </button>
                </div>`;
        }
    </script>
</body>
</html>
