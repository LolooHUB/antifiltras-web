<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <title>‚öôÔ∏è Admin Panel | Anti-Filtras</title>
    <link rel="stylesheet" href="../style.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.1/css/all.min.css">
</head>
<body>
    <div id="login" style="text-align:center; padding-top: 150px;">
        <img src="../logo.webp" width="120" style="margin-bottom:20px;">
        <h2 style="letter-spacing:2px;">üîê ACCESO STAFF</h2>
        <input type="password" id="pass" placeholder="Contrase√±a Maestra" style="padding:15px; width:250px; border-radius:8px; border:1px solid #333; background:#111; color:white;">
        <br><br>
        <button onclick="checkPass()" class="btn-main">ENTRAR üöÄ</button>
    </div>

    <div id="panel" style="display:none;" class="container">
        <div class="admin-card">
            <h2 style="text-align:center; color:var(--green);"><i class="fas fa-terminal"></i> PANEL DE CONTROL</h2>
            <p style="text-align:center; opacity:0.6;">Gestiona las funciones del bot en tiempo real</p>
            <hr style="border:0; border-top:1px solid #333; margin:20px 0;">
            
            <div id="btn-container">
                </div>
            
            <p style="text-align:center; margin-top:30px;">
                <a href="../index.html" style="color:var(--gray); text-decoration:none; font-size:0.8rem;">‚¨ÖÔ∏è Volver a la Web P√∫blica</a>
            </p>
        </div>
    </div>

    <script type="module">
        import { initializeApp } from "https://www.gstatic.com/firebasejs/10.7.1/firebase-app.js";
        import { getFirestore, doc, updateDoc, onSnapshot } from "https://www.gstatic.com/firebasejs/10.7.1/firebase-firestore.js";

        const firebaseConfig = {
            apiKey: "AIzaSyAEUOzOWdq0xs3qiIlX1RzB6bpKkkMLykA",
            authDomain: "antifiltras-7116d.firebaseapp.com",
            projectId: "antifiltras-7116d",
            appId: "1:795745598666:web:72b77816d3c2a3c17f8833"
        };

        const app = initializeApp(firebaseConfig);
        const db = getFirestore(app);

        window.checkPass = () => {
            if(document.getElementById('pass').value === 'Antifiltras2026') {
                document.getElementById('login').style.display = 'none';
                document.getElementById('panel').style.display = 'block';
            } else { alert('‚ùå Acceso Denegado'); }
        };

        onSnapshot(doc(db, "BOT_CONTROL", "settings"), (s) => {
            if(!s.exists()) return;
            const d = s.data();
            const c = document.getElementById('btn-container');
            c.innerHTML = `
                ${renderBtn('üì© Sistema de Tickets', 'ticketsEnabled', d.ticketsEnabled)}
                ${renderBtn('üö´ Baneos Globales', 'bansEnabled', d.bansEnabled)}
                ${renderBtn('‚öôÔ∏è Config. Servidores', 'configEnabled', d.configEnabled)}
            `;
        });

        window.toggleFunc = async (f, v) => {
            await updateDoc(doc(db, "BOT_CONTROL", "settings"), { [f]: !v });
        };

        function renderBtn(label, field, val) {
            return `
                <div class="control-row">
                    <span style="font-weight:bold; font-size:1.1rem;">${label}</span>
                    <button onclick="toggleFunc('${field}', ${val})" class="btn-toggle" style="background:${val ? '#00ff88' : '#ff3e3e'}; color:#000;">
                        ${val ? '‚úÖ ACTIVO' : '‚ùå DESACTIVADO'}
                    </button>
                </div>`;
        }
    </script>
</body>
</html>
